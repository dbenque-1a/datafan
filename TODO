Refactor completely around GRPC to avoid type convertions